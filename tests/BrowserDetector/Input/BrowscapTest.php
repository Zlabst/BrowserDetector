<?php
namespace BrowserDetector\Input;

use phpbrowscap\Browscap;

/**
 * Test class for KreditCore_Class_BrowserDetector.
 * Generated by PHPUnit on 2010-09-05 at 22:13:26.
 */
class InputBrowscapTest extends \PHPUnit_Framework_TestCase
{
    /**
     * @var KreditCore_Class_BrowserDetector
     */
    private $object = null;

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    protected function setUp()
    {
        parent::setUp();

        $this->object = new Browscap();
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown()
    {
        unset($this->object);

        parent::tearDown();
    }

    /**
     * @dataProvider providerGetBrowserFromMod
     */
    public function testGetBrowserFromMod($agent, $browser, $version, $platform)
    {
        $this->markTestSkipped('not implemented yet');

        $this->object->setLocaleFile('tests/data/modified_full_php_browscap.ini');
        $this->object->setCachePrefix('modified_ini_');
        $this->object->setAgent($agent);

        $parser = new Browscap('tests/temp/');

        $this->object->setParser($parser);

        $result = $this->object->getBrowser();

        $this->assertInstanceOf('BrowserDetector\\Detector\\Result', $result);

        $this->assertSame($browser, $result->getCapability('mobile_browser', true), 'browser name mismatch');
        // $this->assertSame($browserVersion, $result->getVersion()->getVersion(\BrowserDetector\Detector\Version::COMPLETE), 'browser version mismatch');
        // $this->assertSame($platform, $result->getPlatform(), 'platform name mismatch');
        // $this->assertSame($platformVersion, $result->getPlatformVersion()->getVersion(\BrowserDetector\Detector\Version::COMPLETE), 'platform version mismach');
        // $this->assertSame($frames, $result->supportsFrames(), 'frames mismatch');
        // $this->assertSame($iframes, $result->supportsIframes(), 'iframes mismatch');
        // $this->assertSame($tables, $result->supportsTables(), 'tables mismatch');
        // $this->assertSame($cookies, $result->supportsCookies(), 'cookies mismatch');
        // $this->assertSame($bgsound, $result->supportsBackgroundSounds(), 'bgsound mismatch');
        // $this->assertSame($javascript, $result->supportsJavaScript(), 'js mismatch');
        // $this->assertSame($vbscript, $result->supportsVbScript(), 'vbs mismatch');
        // $this->assertSame($java, $result->supportsJavaApplets(), 'java mismatch');
        // $this->assertSame($activex, $result->supportsActivexControls(), 'activex mismatch');
        // $this->assertSame($synreader, $result->isSyndicationReader(), 'syndreader mismatch');
        // $this->assertSame($pdf, $result->isPdfSupported(), 'pdf mismatch');
        // $this->assertSame($rss, $result->isRssSupported(), 'rss mismatch');
    }

    public function providerGetBrowserFromMod()
    {
        return array(
            array(
                'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Iron/10.0.650.0 Chrome/10.0.650.0 Safari/534.16',
                'Iron', '10.0', 'WinXP'
            ),
            array(
                'Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0 FirePHP/0.5', 'Firefox', '5.0', 'WinXP'
            ),
            array('Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0', 'Firefox', '5.0', 'WinXP'),
            array(
                'Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1 FirePHP/0.5', 'Firefox', '4.0',
                'WinXP'
            ),
            array(
                'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727)',
                'Internet Explorer', '7.0', 'WinXP'
            ),
            array('Opera/9.52 (Macintosh; Intel Mac OS X; U; en)', 'Opera', '9.50', 'MacOSX'),
            array('Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0', 'Firefox', '5.0', 'WinXP'),
            array(
                'Mozilla/5.0 (Windows NT 5.1) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.122 Safari/534.30',
                'Chrome', '12.0', 'WinXP'
            ),
            array('Jakarta Commons-HttpClient/3.0.1', 'Default Browser', '', 'unknown'),
            array('check_http/v1.4.15 (nagios-plugins 1.4.15)', 'Default Browser', '', 'unknown'),
            array('www.kredit.de', 'www.kredit.de', '', 'Unister'),
            array('Opera/9.80 (Windows NT 6.1; U; en) Presto/2.9.168 Version/11.50', 'Opera', '11.50', 'Win7'),
            array('Mozilla/5.0 (Windows NT 6.0; rv:6.0) Gecko/20100101 Firefox/6.0', 'Firefox', '6.0', 'WinVista'),

            array(
                'Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; de-de) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5',
                'Mobile Safari', '5.0', 'iOS'
            ),
            array(
                'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)', 'Baidu', '2.0',
                'unknown'
            ),
            array(
                'Mozilla/5.0 (iPhone; U; CPU iOS 4_3_3 like Mac OS X; de-de) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5',
                'Safari', '5.0', 'MacOSX'
            ),
            array(
                'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)', 'Internet Explorer',
                '9.0', 'Win7'
            ),

            array(
                'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.15) Gecko/20101028 Iceweasel/3.5.15 unister-test-acceptance',
                'Unister-Testing', '', 'Unister'
            ),

            array(
                'Mozilla/5.0 (Linux; U; Android 2.1-update1; de-de; HTC Dream Build/EPE54B) AppleWebKit/530.17 (KHTML, like Gecko) Version/4.0 Mobile Safari/530.17',
                'Safari', '4.0', 'Linux'
            ),
            array(
                'Mozilla/5.0 (Linux; U; Android 2.2; de-de; HTC Desire 2.33.161.2 Build/FRF91) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',
                'Android Browser', '4.0', 'Android'
            ),
            array(
                'SonyEricssonW910i/R1FA Browser/NetFront/3.4 Profile/MIDP-2.1 Configuration/CLDC-1.1',
                'Access NetFront', '3.4', 'JAVA'
            ),
        );
    }

    /**
     * @dataProvider providerGetBrowserFromOrig
     */
    public function testGetBrowserFromOrig($agent, $browser, $version, $platform)
    {
        $this->markTestSkipped('not implemented yet');

        $this->object->setLocaleFile('tests/data/full_php_browscap.ini');
        $this->object->setCachePrefix('original_ini_');
        $this->object->setAgent($agent);

        $parser = new Browscap('tests/temp/');

        $this->object->setParser($parser);

        $result = $this->object->getBrowser();

        $this->assertInstanceOf('BrowserDetector\\Detector\\Result', $result);

        $this->assertSame($browser, $result->getCapability('mobile_browser', true), 'browser name mismatch');
        // $this->assertSame($browserVersion, $result->getVersion()->getVersion(\BrowserDetector\Detector\Version::COMPLETE), 'browser version mismatch');
        // $this->assertSame($platform, $result->getPlatform(), 'platform name mismatch');
    }

    public function providerGetBrowserFromOrig()
    {
        $agent = 'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.3) Gecko/' . time()
            . ' Firefox/3.6.3 FirePHP/0.4';

        return array(
            array($agent, 'Firefox', '3.6', 'Win7'),
            array(
                'Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US) AppleWebKit/534.16 (KHTML, like Gecko) Iron/10.0.650.0 Chrome/10.0.650.0 Safari/534.16',
                'Chrome', '10.0', 'WinXP'
            ),
            array(
                'Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0 FirePHP/0.5', 'Firefox', '5.0', 'WinXP'
            ),
            array('Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0', 'Firefox', '5.0', 'WinXP'),
            array(
                'Mozilla/5.0 (Windows NT 5.1; rv:2.0.1) Gecko/20100101 Firefox/4.0.1 FirePHP/0.5', 'Firefox', '4.0',
                'WinXP'
            ),
            array(
                'Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729; .NET4.0C; .NET4.0E; .NET CLR 2.0.50727)',
                'IE', '7.0', 'WinXP'
            ),
            array('Opera/9.52 (Macintosh; Intel Mac OS X; U; en)', 'Opera', '9.00', 'MacOSX'),
            array('Mozilla/5.0 (Windows NT 5.1; rv:5.0) Gecko/20100101 Firefox/5.0', 'Firefox', '5.0', 'WinXP'),
            array(
                'Mozilla/5.0 (Windows NT 5.1) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.122 Safari/534.30',
                'Chrome', '12.0', 'WinXP'
            ),
            array('Jakarta Commons-HttpClient/3.0.1', 'Default Browser', '0.0', 'unknown'),
            array('check_http/v1.4.15 (nagios-plugins 1.4.15)', 'Nagios', '1.4', 'unknown'),
            array('www.kredit.de', 'Default Browser', '0.0', 'unknown'),
            array('Opera/9.80 (Windows NT 6.1; U; en) Presto/2.9.168 Version/11.50', 'Opera', '11.50', 'Win7'),
            array('Mozilla/5.0 (Windows NT 6.0; rv:6.0) Gecko/20100101 Firefox/6.0', 'Firefox', '6.0', 'WinVista'),

            array(
                'Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; de-de) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5',
                'Safari', '5.0', 'iOS'
            ),
            array(
                'Mozilla/5.0 (compatible; Baiduspider/2.0; +http://www.baidu.com/search/spider.html)', 'Baiduspider',
                '2.0', 'unknown'
            ),
            array(
                'Mozilla/5.0 (iPhone; U; CPU iOS 4_3_3 like Mac OS X; de-de) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8J2 Safari/6533.18.5',
                'Safari', '5.0', 'iOS'
            ),
            array('Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)', 'IE', '9.0', 'Win7'),

            array(
                'Mozilla/5.0 (X11; U; Linux x86_64; en-US; rv:1.9.1.15) Gecko/20101028 Iceweasel/3.5.15 unister-test-acceptance',
                'Mozilla', '1.9', 'Linux'
            ),

            array(
                'Mozilla/5.0 (Linux; U; Android 2.1-update1; de-de; HTC Dream Build/EPE54B) AppleWebKit/530.17 (KHTML, like Gecko) Version/4.0 Mobile Safari/530.17',
                'Android', '4.0', 'Android'
            ),
            array(
                'Mozilla/5.0 (Linux; U; Android 2.2; de-de; HTC Desire 2.33.161.2 Build/FRF91) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',
                'Android', '4.0', 'Android'
            ),
            array(
                'SonyEricssonW910i/R1FA Browser/NetFront/3.4 Profile/MIDP-2.1 Configuration/CLDC-1.1',
                'Access NetFront', '3.0', 'unknown'
            ),
        );
    }
}